<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Admin | Ca√±ada Barber</title>

<style>
body{
font-family:Arial;
background:#111;
color:white;
padding:40px;
}

h1{
color:#d4af37;
}

.cita{
background:#1a1a1a;
padding:15px;
margin-bottom:10px;
border-radius:10px;
display:flex;
justify-content:space-between;
align-items:center;
}

button{
background:red;
color:white;
border:none;
padding:8px 12px;
border-radius:5px;
cursor:pointer;
}
</style>
</head>
<body>

<h1>Panel de Administrador</h1>

<div id="lista"></div>

<script>
const lista = document.getElementById("lista");

async function cargarCitas(){
  const res = await fetch("/admin/citas");
  const citas = await res.json();

  lista.innerHTML = "";

  if(citas.length === 0){
    lista.innerHTML = "<p>No hay citas registradas.</p>";
    return;
  }

  citas
    .sort((a,b)=> a.fecha.localeCompare(b.fecha) || a.hora.localeCompare(b.hora))
    .forEach(cita => {

      const div = document.createElement("div");
      div.classList.add("cita");

      div.innerHTML = `
        <div>
          <strong>${cita.fecha}</strong> - ${cita.hora}<br>
          ${cita.nombre}<br>
          ${cita.telefono}
        </div>
        <button onclick="eliminar('${cita.fecha}','${cita.hora}')">Eliminar</button>
      `;

      lista.appendChild(div);
    });
}

async function eliminar(fecha, hora){
  await fetch("/admin/eliminar", {
    method:"DELETE",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ fecha, hora })
  });

  cargarCitas();
}

cargarCitas();
</script>

</body>
</html>